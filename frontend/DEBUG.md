# 前端调试指南

## 当前问题

用户遇到了 JSON 解析错误：
```
PatentApp.jsx:148 SyntaxError: Failed to execute 'json' on 'Response': Unexpected end of JSON input
```

## 问题原因

这个错误通常发生在以下情况：
1. **后端服务器未运行** - 前端尝试连接失败的服务器
2. **后端返回非JSON响应** - 服务器返回HTML错误页面而不是JSON
3. **网络连接问题** - CORS或防火墙阻止请求
4. **响应为空** - 服务器没有返回任何内容

## 已实施的修复

### 1. 增强的错误处理
- 网络连接错误检查
- HTTP状态码验证
- 响应内容验证
- JSON解析错误处理

### 2. 详细的错误消息
现在前端会显示更具体的错误信息：
- "网络连接失败: 请检查后端服务器是否正在运行"
- "HTTP 404: Not Found"
- "响应解析失败: 服务器可能返回了非JSON格式的响应"
- "服务器返回空响应"

### 3. 分层错误处理
- 网络层错误（连接失败）
- HTTP层错误（状态码错误）
- 解析层错误（JSON格式错误）

## 调试步骤

### 步骤1: 检查后端服务器状态
1. 打开浏览器开发者工具 (F12)
2. 切换到 Network 标签
3. 尝试在前端提交表单
4. 查看失败的请求：
   - 请求URL
   - HTTP状态码
   - 响应内容

### 步骤2: 验证后端API
直接访问以下URL测试API：
- `http://localhost:3000/api/health` - 健康检查
- `http://localhost:3000/` - 主页

### 步骤3: 检查端口配置
- 前端: http://localhost:5174
- 后端: http://localhost:3000
- 确保两个服务都在运行

### 步骤4: 查看浏览器控制台
1. 打开 F12 开发者工具
2. 切换到 Console 标签
3. 查看详细的错误信息和堆栈跟踪

## 临时解决方案

如果后端暂时无法启动，可以：

1. **使用简化测试服务器**
   ```bash
   cd backend
   python simple_server.py
   ```

2. **前端测试模式**
   - 前端现在会显示更清晰的错误信息
   - 可以测试UI交互和表单验证

3. **Mock API响应** (用于前端开发)
   - 可以在浏览器控制台中模拟API响应
   - 测试前端逻辑是否正确

## 常见错误及解决方案

### 错误1: "网络连接失败"
**原因**: 后端服务器未启动
**解决**: 启动后端服务器

### 错误2: "HTTP 404: Not Found"
**原因**: API路径错误
**解决**: 检查后端路由配置

### 错误3: "响应解析失败"
**原因**: 后端返回HTML错误页面
**解决**: 检查后端日志，修复服务器错误

### 错误4: "CORS policy error"
**原因**: 跨域请求被阻止
**解决**: 配置后端CORS设置

## 开发建议

1. **先确保后端工作**，再测试前端
2. **使用浏览器开发者工具**进行调试
3. **查看网络请求**了解具体问题
4. **逐步测试**每个API端点

## 当前状态

- ✅ 前端错误处理已增强
- ✅ 错误消息已改进
- ✅ 网络问题检测已添加
- ⚠️ 需要启动后端服务器进行完整测试

修复完成后，前端将能够：
- 清楚地显示连接问题
- 提供有用的错误信息
- 优雅地处理服务器不可用的情况